---
export interface Props {
  title: string;
  description?: string;
  image?: string;
  canonical?: string;
}

const { title, description, image, canonical } = Astro.props;

// Get the site URL from Astro config or default
const siteUrl = Astro.site?.toString() || 'https://dynast-ia.org';

// Resolve image URL to absolute if it's relative
const resolvedImage = image 
  ? image.startsWith('http') 
    ? image 
    : new URL(image, siteUrl).toString()
  : undefined;

// Use current URL as canonical if not provided
const canonicalURL = canonical || Astro.url.href;

// Default description if not provided
const metaDescription = description || "Dynastia - Accélérateur de startups innovantes au Québec. Propulsez votre croissance avec notre expertise et notre réseau.";
---

<!-- Primary Meta Tags -->
<title>{title}</title>
<meta name="title" content={title} />
<meta name="description" content={metaDescription} />
<link rel="canonical" href={canonicalURL} />

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website" />
<meta property="og:url" content={canonicalURL} />
<meta property="og:title" content={title} />
<meta property="og:description" content={metaDescription} />
{resolvedImage && <meta property="og:image" content={resolvedImage} />}
<meta property="og:site_name" content="Dynastia" />
<meta property="og:locale" content="fr_CA" />

<!-- Twitter -->
<meta property="twitter:card" content={resolvedImage ? "summary_large_image" : "summary"} />
<meta property="twitter:url" content={canonicalURL} />
<meta property="twitter:title" content={title} />
<meta property="twitter:description" content={metaDescription} />
{resolvedImage && <meta property="twitter:image" content={resolvedImage} />}

<!-- Additional SEO tags -->
<meta name="robots" content="index, follow" />
<meta name="googlebot" content="index, follow" />
<meta name="author" content="Dynastia" />
<meta name="publisher" content="Dynastia" />